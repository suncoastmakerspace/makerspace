---
interface Service {
    title: string;
    description: string;
    gradient: 'blue' | 'purple' | 'green';
    icon: string;
}

interface Props {
    services: Service[];
}

const { services } = Astro.props;

const gradients = {
    blue: 'from-blue-400 to-indigo-500',
    purple: 'from-purple-400 to-pink-500',
    green: 'from-green-400 to-cyan-500',
};
---

<div class="relative">
    <div class="overflow-hidden">
        <div id="carousel-container" class="flex transition-transform duration-500 ease-out" style="width: 100%;">
            {services.map((service) => (
                <div class="w-full shrink-0 px-4">
                    <div class={`h-80 rounded-2xl bg-linear-to-br ${gradients[service.gradient]} flex flex-col items-center justify-center text-white shadow-lg hover:shadow-2xl transition-all duration-300`}>
                        <div class="mb-6">
                            <svg class="w-24 h-24 opacity-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={service.icon} />
                            </svg>
                        </div>
                        <h3 class="text-3xl font-bold mb-4 text-center">{service.title}</h3>
                        <p class="text-lg text-center max-w-xs leading-relaxed">{service.description}</p>
                    </div>
                </div>
            ))}
        </div>
    </div>

    <!-- Navigation Buttons -->
    <button 
        id="prev-button" 
        class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 md:-translate-x-6 z-10 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full p-3 transition-all duration-150 hover:scale-110 active:scale-95"
        aria-label="Previous slide"
    >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
    </button>

    <button 
        id="next-button" 
        class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 md:translate-x-6 z-10 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full p-3 transition-all duration-150 hover:scale-110 active:scale-95"
        aria-label="Next slide"
    >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
    </button>

    <!-- Dot Indicators -->
    <div class="flex justify-center gap-2 mt-8">
        {services.map((_, index) => (
            <button 
                class="dot w-3 h-3 rounded-full bg-gray-300 hover:bg-indigo-600 transition-all duration-150"
                data-index={index}
                aria-label={`Go to slide ${index + 1}`}
            />
        ))}
    </div>
</div>

<script>
    const container = document.getElementById('carousel-container') as HTMLElement;
    const prevButton = document.getElementById('prev-button') as HTMLButtonElement;
    const nextButton = document.getElementById('next-button') as HTMLButtonElement;
    const dots = document.querySelectorAll('.dot') as NodeListOf<HTMLButtonElement>;

    let currentIndex = 0;
    const totalSlides = dots.length;

    function updateCarousel() {
        const offset = -currentIndex * 100;
        container.style.transform = `translateX(${offset}%)`;

        dots.forEach((dot, index) => {
            dot.classList.toggle('bg-indigo-600', index === currentIndex);
            dot.classList.toggle('bg-gray-300', index !== currentIndex);
        });
    }

    function goToSlide(index: number) {
        currentIndex = (index + totalSlides) % totalSlides;
        updateCarousel();
    }

    prevButton.addEventListener('click', () => goToSlide(currentIndex - 1));
    nextButton.addEventListener('click', () => goToSlide(currentIndex + 1));

    dots.forEach((dot, index) => {
        dot.addEventListener('click', () => goToSlide(index));
    });

    // Initialize
    updateCarousel();
</script>
